# 游戏倒计时和颜料占比系统使用说明

## 概述

新增了2分钟倒计时系统和实时颜料占比显示功能，包括游戏内HUD显示和游戏结束面板的最终统计。

## 系统功能

### 1. 倒计时系统
- **游戏时长**: 默认2分钟（120秒），可在GameManager中调整
- **自动结束**: 倒计时结束后自动触发游戏结束
- **获胜判定**: 基于颜料占比确定获胜者（玩家占比>50%获胜）

### 2. 颜料占比计算
- **实时计算**: 每辆车的颜料占总颜料的百分比
- **排序显示**: 按占比从高到低排序
- **详细统计**: 显示占比百分比和颜料块数

### 3. UI显示系统
- **游戏内HUD**: 实时显示倒计时和各车辆占比
- **游戏结束面板**: 显示最终的颜料占比统计

## 新增组件

### 1. GameHUD（游戏内HUD）
**功能**: 游戏进行时的实时信息显示

**属性配置**:
- `countdownLabel`: 倒计时显示标签
- `playerRatioLabel`: 玩家占比文字显示
- `playerRatioBar`: 玩家占比进度条
- `aiRatiosContainer`: AI占比显示容器
- `updateInterval`: UI更新频率（默认0.1秒）

### 2. GameManager直接控制游戏结束面板
**新增属性**:
- `paintRatiosContainer`: 颜料占比显示容器
- `paintRatiosTitleLabel`: 占比统计标题

**注意**: GameOverPanel脚本未被使用，所有UI控制都通过GameManager直接操作

## 配置步骤

### 1. 配置GameManager
1. 在GameManager组件中找到新增属性：
   - `gameDuration`: 设置游戏时长（默认120秒）
   - `gameHUD`: 拖拽GameHUD组件引用
   - `paintRatiosContainer`: 拖拽游戏结束面板中的颜料占比容器
   - `paintRatiosTitleLabel`: 拖拽游戏结束面板中的占比标题标签

### 2. 创建GameHUD界面
1. 在游戏场景中创建HUD节点
2. 添加GameHUD脚本组件
3. 创建并配置子节点：

#### 倒计时显示：
```
HUD
├── CountdownLabel (Label组件)
```

#### 玩家占比显示：
```
HUD
├── PlayerRatio
    ├── PlayerRatioLabel (Label组件)
    └── PlayerRatioBar (ProgressBar组件)
```

#### AI占比显示：
```
HUD
├── AIRatiosContainer (空节点)
    └── (动态创建AI占比标签)
```

### 3. 配置游戏结束面板UI
1. 在游戏结束面板场景中添加：
   - 创建空节点作为颜料占比容器
   - 创建标题标签显示"颜料占比统计"
2. 在GameManager中配置引用：
   - 将容器节点拖拽到`paintRatiosContainer`属性
   - 将标题标签拖拽到`paintRatiosTitleLabel`属性

## UI布局建议

### 游戏内HUD布局
```
屏幕顶部中央: 倒计时 (02:00)
屏幕右上角: 
  玩家: 45% [进度条]
  AI-car1: 30%
  AI-car2: 25%
```

### 游戏结束面板布局
```
现有内容
├── 胜利/失败标题
├── 表现评价
├── 获得金币
├── 游戏时长
├── 剩余生命值
└── 新增: 颜料占比统计
    ├── 玩家: 45% (23块)
    ├── AI-car1: 30% (15块)
    └── AI-car2: 25% (13块)
```

## 系统特性

### 1. 实时更新
- HUD每0.1秒更新一次显示
- 颜料占比实时计算
- 倒计时精确到秒

### 2. 性能优化
- 使用缓存减少重复计算
- 按需创建UI元素
- 合理的更新频率

### 3. 用户体验
- 倒计时少于30秒时颜色变红提醒
- 清晰的车辆名称显示
- 详细的统计信息

## 获胜规则

1. **时间结束**: 2分钟倒计时结束
2. **占比判定**: 玩家颜料占比 > 50% 则获胜
3. **无颜料**: 如果没有任何颜料，玩家失败

## 调试信息

系统会在控制台输出：
- 倒计时结束信息
- 最终颜料占比
- 获胜判定结果

## 扩展功能

系统支持以下扩展：
- 自定义游戏时长
- 不同的获胜条件
- 更复杂的占比计算规则
- 动画效果和视觉增强

## 注意事项

1. 确保GameManager中正确配置了GameHUD引用
2. HUD容器节点需要正确的层级结构
3. 游戏结束面板的容器节点要有足够的空间显示占比信息
4. 建议在不同分辨率下测试UI布局
